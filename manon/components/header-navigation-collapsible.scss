@use "../mixins/theming";
@use "../variables" as theme;
@use "../functions/validators";

body > header nav.collapsible {
  @include theming.apply-from-theme(
    (
      // Collapsible mixin variables
    )
  );

  &.collapsed {
    /* Menu below breakpoint */
    button.collapsible-toggle {
      order: 1;
      margin-left: auto;
      border: 0;
      gap: 0;

      @include theming.apply-from-theme(
        (
          background-color: theme.$header-navigation-collapsible-button-background-color,
          font-size: theme.$header-navigation-collapsible-button-font-size,
          height: theme.$header-navigation-collapsible-button-height,
          min-height: theme.$header-navigation-collapsible-button-min-height,
          min-width: theme.$header-navigation-collapsible-button-min-width,
          width: theme.$header-navigation-collapsible-button-width,
        )
      );

      &::before {
        line-height: initial;
        background-color: transparent;

        @include theming.apply-from-theme(
          (
            content: theme.$header-navigation-collapsible-icon,
            font-size: theme.$header-navigation-collapsible-icon-font-size,
            color: theme.$header-navigation-collapsible-icon-color,
          )
        );
      }

      &[aria-expanded="true"]::before {
        @include theming.apply-from-theme(
          (
            content: theme.$header-navigation-collapsible-icon-collapsed,
            font-size: theme.$header-navigation-collapsible-icon-collapsed-font-size,
            color: theme.$header-navigation-collapsible-icon-color,
          )
        );
      }

      &[aria-expanded="true"] {
        /* Element that will be collapsed */
        + .collapsing-element {
          max-height: initial;
          height: auto;
          box-sizing: border-box;
          position: absolute;

          @include theming.apply-from-theme(
            (
              flex-direction: theme.$header-navigation-collapsible-flex-direction,
              justify-content: theme.$header-navigation-collapsible-justify-content,
              gap: theme.$header-navigation-collapsible-gap,
              max-width: theme.$header-navigation-collapsible-max-width,
              width: theme.$header-navigation-collapsible-width,
              z-index: theme.$header-navigation-collapsible-z-index,
              padding-top: theme.$header-navigation-collapsible-padding-top,
              padding-right: theme.$header-navigation-collapsible-padding-right,
              padding-bottom: theme.$header-navigation-collapsible-padding-bottom,
              padding-left: theme.$header-navigation-collapsible-padding-left,
              border-width: theme.$header-navigation-collapsible-border-width,
              border-style: theme.$header-navigation-collapsible-border-style,
              border-color: theme.$header-navigation-collapsible-border-color,
              background-color: theme.$header-navigation-collapsible-background-color,
              color: theme.$header-navigation-collapsible-text-color,
              box-shadow: theme.$header-navigation-collapsible-box-shadow,
              top: theme.$header-navigation-collapsible-top,
              left: theme.$header-navigation-collapsible-left,
              right: theme.$header-navigation-collapsible-right,
            )
          );

          ul,
          ol {
            display: flex;
            flex-direction: column;
            width: 100%;
            margin: 0;
            padding: 0;

            @include theming.apply-from-theme(
              (
                gap: theme.$header-navigation-collapsible-list-gap,
                background-color: theme.$header-navigation-collapsible-list-background-color,
              )
            );

            li {
              list-style: none;
              padding: 0;
              display: flex;
              order: 1;
              margin: 0;
              width: 100%;
              box-sizing: border-box;

              @include theming.apply-from-theme(
                (
                  align-items: theme.$header-navigation-collapsible-list-item-align-items,
                  background-color: theme.$header-navigation-collapsible-list-item-background-color,
                  color: theme.$header-navigation-collapsible-list-item-text-color,
                  border-width: theme.$header-navigation-collapsible-list-item-border-width,
                  border-style: theme.$header-navigation-collapsible-list-item-border-style,
                  border-color: theme.$header-navigation-collapsible-list-item-border-color,
                  padding-top: theme.$header-navigation-collapsible-list-item-padding-top,
                  padding-right: theme.$header-navigation-collapsible-list-item-padding-right,
                  padding-bottom: theme.$header-navigation-collapsible-list-item-padding-bottom,
                  padding-left: theme.$header-navigation-collapsible-list-item-padding-left,
                )
              );

              &::before {
                display: none;
                /* Preventing default nav before to show up */
              }

              &:last-child {
                @include theming.apply-from-theme(
                  (
                    border-width: theme.$header-navigation-collapsible-list-item-last-item-border-width,
                  )
                );
              }

              &:first-child {
                @include theming.apply-from-theme(
                  (
                    border-width: theme.$header-navigation-collapsible-list-item-first-item-border-width,
                  )
                );
              }

              a {
                width: 100%;
                max-width: 100%;
                padding: 0;
                box-sizing: border-box;
                border: 0;
                white-space: nowrap;
                text-overflow: ellipsis;
                overflow: hidden;

                @include theming.apply-from-theme(
                  (
                    text-decoration: theme.$header-navigation-collapsible-list-item-link-text-decoration,
                    justify-content: theme.$header-navigation-collapsible-list-item-link-justify-content,
                    background-color: theme.$header-navigation-collapsible-list-item-link-background-color,
                    color: theme.$header-navigation-collapsible-list-item-link-text-color,
                    padding-top: theme.$header-navigation-collapsible-list-item-link-padding-top,
                    padding-right: theme.$header-navigation-collapsible-list-item-link-padding-right,
                    padding-bottom: theme.$header-navigation-collapsible-list-item-link-padding-bottom,
                    padding-left: theme.$header-navigation-collapsible-list-item-link-padding-left,
                    min-height: theme.$header-navigation-collapsible-list-item-link-min-height,
                    height: theme.$header-navigation-collapsible-list-item-link-height,
                  )
                );

                &:hover {
                  @include theming.apply-from-theme(
                    (
                      background-color: theme.$header-navigation-collapsible-list-item-link-hover-background-color,
                      color: theme.$header-navigation-collapsible-list-item-hover-text-color,
                      text-decoration: theme.$header-navigation-collapsible-list-item-hover-text-decoration,
                    )
                  );

                  a {
                    @include theming.apply-from-theme(
                      (
                        background-color: theme.$header-navigation-collapsible-list-item-link-hover-background-color,
                        color: theme.$header-navigation-collapsible-list-item-link-hover-text-color,
                      )
                    );

                    &:visited {
                      @include theming.apply-from-theme(
                        (
                          background-color: theme.$header-navigation-collapsible-list-item-link-hover-background-color,
                        )
                      );
                    }
                  }
                }

                &[aria-current] {
                  @include theming.apply-from-theme(
                    (
                      font-size: theme.$header-navigation-collapsible-list-item-link-selected-font-size,
                      font-weight: theme.$header-navigation-collapsible-list-item-link-selected-font-weight,
                      line-height: theme.$header-navigation-collapsible-list-item-link-selected-line-height,
                      background-color: theme.$header-navigation-collapsible-list-item-link-selected-background-color,
                      color: theme.$header-navigation-collapsible-list-item-link-selected-text-color,
                      text-decoration: theme.$header-navigation-collapsible-list-item-link-selected-text-decoration,
                      border-width: theme.$header-navigation-collapsible-list-item-link-selected-border-width,
                      border-style: theme.$header-navigation-collapsible-list-item-link-selected-border-style,
                      border-color: theme.$header-navigation-collapsible-list-item-link-selected-border-color,
                      border-radius: theme.$header-navigation-collapsible-list-item-link-selected-border-radius,
                    )
                  );
                }
              }

              /* Selected language */
              &[aria-current="true"] {
                order: 0;
                cursor: pointer;
                font-family: inherit;

                @include theming.apply-from-theme(
                  (
                    background-color: theme.$header-navigation-collapsible-list-item-active-background-color,
                    color: theme.$header-navigation-collapsible-list-item-active-text-color,
                    font-size: theme.$header-navigation-collapsible-list-item-active-font-size,
                    font-weight: theme.$header-navigation-collapsible-list-item-active-font-weight,
                  )
                );
              }
            }
          }
        }
      }
    }

    /* collapsible menu button.
    /* This button is only visisble when javascript is loaded. */
    /* Do not add the button to the html manually, JS will do this. */
    /* When JS isn't available the menu will be opened by default for accessibility. */
    button.collapsible-toggle {
      /* JS menu collapsed behaviour */
      &[aria-expanded="false"] {
        & ~ * {
          display: flex;
        }
      }
    }
  }
}
