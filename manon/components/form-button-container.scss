@use "../mixins/apply-from-theme";
@use "../variables" as theme;
@use "../functions/not-null";

$breakpoint: 24rem !default;

%fieldset-button-container-styling {
  /* Removing gap as it is not supported within fieldsets */
  gap: 0;
  width: auto;
  @include apply-from-theme.apply-from-theme(
    (
      float: theme.$form-button-container-fieldset-float,
    )
  );

  $styles: ();
  @if theme.$button-container-gap != null {
    $styles: map-merge(
      $styles,
      (
        /* Countering margin bottom that will be set by buttons on the last line */
        margin-right: calc((theme.$button-container-gap) * -1) /
          2,
        margin-bottom: calc(theme.$button-container-gap) * -1,
        margin-left: calc((theme.$button-container-gap) * -1) / 2
      )
    );
  }
  @include apply-from-theme.apply-from-theme($styles);

  button,
  a.button,
  input[type="button"],
  input[type="submit"],
  input[type="reset"] {
    float: left;
    @include apply-from-theme.apply-from-theme(
      (
        width: theme.$button-container-button-width,
      )
    );

    $styles: ();
    @if theme.$button-container-gap != null {
      $styles: map-merge(
        $styles,
        (
          margin-right: calc(theme.$button-container-gap) / 2,
          margin-left: calc(theme.$button-container-gap) / 2,
          margin-bottom: theme.$button-container-gap,
        )
      );
    }
    @include apply-from-theme.apply-from-theme($styles);

    @media (width >= $breakpoint) {
      @include apply-from-theme.apply-from-theme(
        (
          width: theme.$button-container-button-after-breakpoint-width,
        )
      );
    }
  }
}

form {
  .button-container {
    width: auto;

    @include apply-from-theme.apply-from-theme(
      (
        align-self: theme.$form-button-container-align-self,
      )
    );
  }

  fieldset {
    .button-container {
      @extend %fieldset-button-container-styling;
    }

    > div {
      &.button-container {
        @extend %fieldset-button-container-styling;
      }
    }
  }

  &.horizontal-view {
    fieldset {
      .button-container {
        @extend %fieldset-button-container-styling;

        @media (width >= $breakpoint) {
          $styles: ();
          @if not-null.not-null(theme.$label-colum, theme.$button-container-gap)
          {
            $styles: map-merge(
              $styles,
              (
                margin-left: calc(theme.$label-column) -
                  (
                    theme.$button-container-gap,
                  ) /
                  2,
              )
            );
          }
        }
      }

      > div.button-container {
        @include apply-from-theme.apply-from-theme(
          (
            gap: theme.$button-container-gap,
          )
        );
      }
    }
  }
}
